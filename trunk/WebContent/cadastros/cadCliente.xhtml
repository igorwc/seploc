<ui:composition xmlns="http://www.worg/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich"
      template="../templatepage/masterpage.xhtml">

<!-- TAXINOMIA -->      
<ui:define name="taxinomia">
   	<h:outputText value="#{msgs.tax_cad_root}"/> <img src="../imgs/ponto.png"/> 
   	<h:outputText value="#{msgs.tax_cad_cliente}"/>
</ui:define>      

<!-- CONTEUDO -->      
<ui:define name="conteudo"> 
<style type="text/css">  
.row1 {   
    background-color: #EDEBEB;   
    font-size: 10px;   
}   
.row2 {   
    background-color: #ffffff;   
    font-size: 10px;   
}   
.col1 {
	text-align: center;
}  
.texto {
	font-family: arial,tahoma;
	font-size: 10pt;
	color: #00008B;
}  
.error { 
	font-weight: bold;
	font-style:normal;
	color:#FF0000;
	font-size: 8pt;
	font-family: tahoma, arial;
}
.scrollerCell {
    padding-right: 10px;
    padding-left: 10px;
    height: 15pt;
}
</style> 



   <f:view>  
   	  
   	   <script type="text/javascript" >
             					(function($j){
                 					$j(function(){
    	             					$j('.CEP').setMask();
    	             					$j('.PHONE').setMask();
                     				}
                  				);
              				})(jQuery);  
          				 </script>
           <rich:panel header="Cliente">
			   <!-- Formulario -->
			   <center>
               <rich:panel header="Cadastro de Cliente" id="clientePanel" style="width: 600px">
                  <h:form id="cadCliente" enctype="UTF-8" prependId="false" >
                    <table	border="0" id="clientForm" width="100%" >  
                     <a4j:outputPanel layout="none">
					   <tr align="left">
						<td>
						      <h:outputText value="Tipo Documento: " 
						                    styleClass="texto"/>
						</td>
						<td>
							<a4j:outputPanel layout="block">
					    		<h:selectOneRadio id="tpDocCli"  value="#{clienteCB.clienteMB.opDocCliente}" binding="#{clienteCB.selectDocType}" >
									<f:selectItem id="doc1" itemLabel="CNPJ" itemValue="1"  />
									<f:selectItem id="doc2" itemLabel="CPF" itemValue="2"  />
									<a4j:support event="onclick" reRender="docLabel,docinput" action="#{clienteCB.limpaDoc}" ajaxSingle="true" />
									<f:convertNumber integerOnly="true" type="number"/>
					    		</h:selectOneRadio>
					   		</a4j:outputPanel>
                   		</td>   
						<td> 
							<a4j:outputPanel id="docLabel"  >  
					    		<h:outputText value="Número CNPJ: " 
					    					  styleClass="texto"  
					    					  rendered="#{clienteCB.clienteMB.opDocCliente == clienteCB.CNPJ}" />
					    		<h:outputText value="Número CPF: " 
					    					  styleClass="texto" 
					    					  rendered="#{clienteCB.clienteMB.opDocCliente ==  clienteCB.CPF}"/>
					    	</a4j:outputPanel>    
						</td>
						<td>
						<a4j:outputPanel id="docinput"  > 
							<script type="text/javascript" >
             						(function($j){
                 						$j(function(){
    	             						$j('.seplocCPF').setMask();
    	              						$j('.seplocCNPJ').setMask();
                     					}
                  					);
              					})(jQuery);  
          				 	</script>
					     	<h:inputText 
					                  rendered="#{clienteCB.clienteMB.opDocCliente == clienteCB.CNPJ}"
									  styleClass="seplocCNPJ" 
									  alt="cnpj"
									  id = "cnpjCli"
									  binding="#{clienteCB.inputCNPJ}"
									  validator="#{clienteCB.validateCNPJ}">
					           <f:converter converterId="SeplocCNPJConverter" /> 
					           <rich:ajaxValidator event="onkeyup" />
                        	</h:inputText>
                        	<h:inputText
                                     rendered="#{clienteCB.clienteMB.opDocCliente  == clienteCB.CPF}"	
									 styleClass="seplocCPF" 
									 alt="cpf"
									 id = "cpfCli"
									 binding="#{clienteCB.inputCPF}"
									 validator="#{clienteCB.validateCPF}">        
					            <f:converter converterId="SeplocCPFConverter" /> 
					            <rich:ajaxValidator event="onkeyup" />                              
                        	</h:inputText>
                        </a4j:outputPanel>    
                    	</td>                         
				    </tr>			
				   </a4j:outputPanel>	
					<tr>
						<td colspan="3" align="left">
						</td>
						<td colspan="1" align="left">
					    	<rich:message for="cnpjCli" styleClass="error" />
					    	<rich:message for="cpfCli" styleClass="error" />
						</td>					
					</tr>
					<tr align="left">
                        <td><h:outputText value="Razão Social: " 
                                          styleClass="texto"/>
                        </td>
                        <td><h:inputText value="#{clienteCB.clienteMB.cliente.razao}" 
                                         validator="#{clienteCB.validateRazaoSocial}"                                  
                                         id="razaoCli" >                             
                             <rich:ajaxValidator event="onkeyup"  />                            
                        </h:inputText>                        
                        </td>                    
                        <td>
                            <h:outputText value="Nome Fantasia: " 
                                          styleClass="texto"/>
                        </td>
                        <td>
                            <h:inputText value="#{clienteCB.clienteMB.cliente.fantasia}" 
                                         validator="#{clienteCB.validateFantasia}"  
                                         id="fantasiaCli">      
                               <rich:ajaxValidator event="onkeyup"  />                                                 
                            </h:inputText> 
                        </td>                    
                    </tr>
                    <tr>
                        <td colspan="2">
                            <rich:message for="razaoCli" 
                                          styleClass="error" />
                        </td>
                        <td colspan="2">
                            <rich:message for="fantasiaCli" 
                                          styleClass="error" />
                        </td>
                    </tr>
                    <tr align="left">
                        <td>
                            <h:outputText value="Endereço: " styleClass="texto"/>
                        </td>
                        <td colspan="3">
                            <h:inputText value="#{clienteCB.clienteMB.cliente.endereco}" 
                                         id="enderCli" 
                                         size="65" 
                                         maxlength="65"
                           />                        
                        </td>                    
                    </tr>
                    <tr>
                        <td colspan="4">
                            <rich:message for="enderCli" styleClass="error" />
                        </td>                 
                    </tr>   
                    <tr align="left">
                        <td>
                            <h:outputText value="Localidade: " 
                                          styleClass="texto"/>
                        </td>
                        <td colspan="3">
                            <h:inputText value="#{clienteCB.clienteMB.localidade}" 
                                         id="localidadeCli" 
                                         size="63"
                                         readonly="true"
                                         required="true" 
                            />
                            <a4j:commandLink ajaxSingle="true" 
                                             id="editLocalidade" 
                                             oncomplete="#{rich:component('chooseLocal')}.show();return false;">
                                <h:graphicImage value="../imgs/botao-editar.png" 
                                                style="border:0" />                  
                            </a4j:commandLink>
                        </td>           
                    </tr>
                    <tr>
                        <td colspan="4">
                            <rich:message for="localidadeCli" 
                                          styleClass="error" />
                        </td>
                    </tr>
                    <tr align="left">
                        <td>
                            <h:outputText value="Bairro: " 
                                          styleClass="texto"/>
                        </td>
                        <td>
                            <a4j:outputPanel id="bairro" >
                                <h:inputText id="bairroCli" 
                                             value="#{clienteCB.clienteMB.cliente.bairro}" />
                                <rich:suggestionbox for="bairroCli" minChars="2"
                                                    fetchValue="#{sug_bairro.nome}" 
                                                    nothingLabel="Bairro não encontrado."
                                                    suggestionAction="#{clienteCB.clienteMB.complementoBairro}" 
                                                    var="sug_bairro">
                                    <h:column>
                                        <h:outputText value="#{sug_bairro.nome}" />
                                    </h:column>
                                    <a4j:support ajaxSingle="true" 
                                                 event="onselect">
                                        <f:setPropertyActionListener value="#{sug_bairro.id}"
                                                                     target="#{navigationBean.codBairro}" />
                                    </a4j:support>
                                </rich:suggestionbox> 
                            </a4j:outputPanel>                    
                        </td>          
                        <td>
                            <h:outputText value="CEP: " styleClass="texto"/>
                        </td>
                        <td>
                            <h:inputText value="#{clienteCB.clienteMB.cliente.cep}" 
                                         id="cepCli"
                                         alt="cep"
                                         styleClass="CEP">                                                         
                            </h:inputText>                        
                        </td>    
                    </tr>
                    <tr>
                        <td colspan="2">
                            <rich:message for="bairroCli" 
                                          styleClass="error" />
                        </td>
                        <td colspan="2">
                            <rich:message for="cepCli" 
                                          styleClass="error" />
                        </td>
                    </tr>
                    <tr align="left">
                        <td>
                            <h:outputText value="Fone Comercial: " 
                                          styleClass="texto"/>
                        </td>
                        <td>
                            <h:inputText value="#{clienteCB.clienteMB.foneCliente.foneComercial}" 
                                         id="foneComCli"
                                         alt="phone"
                                         styleClass="PHONE">                                                         
                            </h:inputText>
                        </td>                    
                        <td>
                            <h:outputText value="Fone Residencial: " 
                                          styleClass="texto"/>
                        </td>
                        <td>
                            <h:inputText value="#{clienteCB.clienteMB.foneCliente.foneResidencial}" 
                                         id="foneResCli"
                                         alt="phone"
                                         styleClass="PHONE">                             
                            </h:inputText>
                        </td>                    
                    </tr> 
                    <tr align="left">
                        <td>
                            <h:outputText value="Celular: " 
                                          styleClass="texto"/>
                        </td>
                        <td>
                            <h:inputText value="#{clienteCB.clienteMB.foneCliente.celular}" 
                                         id="celCli"
                                         alt="phone"
                                         styleClass="PHONE">                                                       
                            </h:inputText>
                        </td>                    
                        <td>
                            <h:outputText value="Fone Fax: " 
                                          styleClass="texto"/>
                        </td>
                        <td>
                            <h:inputText value="#{clienteCB.clienteMB.foneCliente.fax}" 
                                         id="faxCli"
                                         alt="phone"
                                         styleClass="PHONE">                                                      
                            </h:inputText>
                        </td>  
                    </tr>
                    <tr align="left">
                        <td>
                            <h:outputText value="E-mail: " 
                                styleClass="texto"/>
                        </td>
                        <td>
                            <h:inputText value="#{clienteCB.clienteMB.cliente.email}" 
                                         validator="#{clienteCB.validateEmail}"
                                         id="emailCli">       
                                <rich:ajaxValidator event="onkeyup"  />                                                 
                            </h:inputText>
                        </td>                    
                        <td>
                            <h:outputText value="Inscrição: " 
                                          styleClass="texto"/>
                        </td>
                        <td>
                            <h:inputText value="#{clienteCB.clienteMB.cliente.inscricao}" 
                                         id="inscricaoCli">                                                      
                            </h:inputText>
                        </td>
                    </tr>      
                    <tr>
                        <td></td>
                        <td>
                            <rich:message for="emailCli" 
                                          styleClass="error" />
                        </td>
                        <td colspan="2"></td>
                    </tr>
                    <tr align="left">
                        <td>
                            <h:outputText value="Observação: " 
                                          styleClass="texto"/>
                        </td>
                        <td colspan="3">
                            <h:inputTextarea value="#{clienteCB.clienteMB.cliente.obs}" 
                                             required="false"                                     
                                             id="obsCli"
                                             cols="50" 
                                             rows="3"/>
                        </td>                    
                    </tr>    
                    <tr align="left">
                        <td>
                            <h:outputText value="Entrega Padrão: " 
                                          styleClass="texto"/>
                        </td>
                        <td>
                            <h:selectOneMenu value="#{clienteCB.clienteMB.cliente.entregaPadrao.local}" 
                                             required="false"                                    
                                             id="entregaPadraoCli">
                                <f:selectItems value="#{entregaBean.lista}" />                                                       
                            </h:selectOneMenu>
                        </td> 
                        <td>
                            <rich:comboBox selectFirstOnUpdate="false"
                                           defaultLabel="Local de Entrega"
                                           id="entregaPadraoCli" 
                                           value="#{clienteBean.entregaCliente}"
                                           validator="#{appBean.validateEntrega}" >
                                <f:selectItems value="#{appBean.locaisEntrega}" />
                                <rich:ajaxValidator event="onkeyup"  />    
                                <rich:ajaxValidator event="onchange"  />  
                            </rich:comboBox>
                        </td>                                        
                        <td>
                            <h:outputText value="Papel Padrão: " 
                                          styleClass="texto"/>
                        </td>
                        <td>
                            <rich:comboBox selectFirstOnUpdate="false"
                                           defaultLabel="Nome do Papel"
                                           id="papelPadraoCli" 
                                           value="#{clienteBean.papelCliente}"
                                           validator="#{appBean.validatePapeis}">
                         <f:selectItems value="#{appBean.papeis}"  />
                        <rich:ajaxValidator event="onkeyup"  />    
                        <rich:ajaxValidator event="onchange"  />   
                    </rich:comboBox>
                    </td>                    
                    </tr>          
				 </table> 
				</h:form>
              </rich:panel>
           </center>
               <!-- fim Formulario -->
        </rich:panel>            
         
        <!-- MODAL DE SELECAO DE CIDADE ESTADO -->
        <rich:modalPanel id="chooseLocal" 
                         autosized="true" 
                         width="300" 
                         height="300">
            <f:facet name="header" >
                <h:outputText value="#{msgs['forms.cliente.buscalocalidade']}" 
                              style="padding-right:15px;" />
            </f:facet>
            <f:facet name="controls">
                <h:panelGroup>
                    <h:graphicImage value="../imgs/icons/close.png" 
                                    styleClass="hidelink"
                                    id="closepanel" />
                    <rich:componentControl for="chooseLocal" 
                                           attachTo="closepanel"
                                           operation="hide" 
                                           event="onclick" />
                </h:panelGroup>
            </f:facet>
            <h:form prependId="false">
                <rich:dataTable value="#{clienteCB.clienteMB.todasCidades}" 
                                var="cid" 
                                rows="10"
                                reRender="ds" 
                                id="simpletable" >
                    <f:facet name="header">
                        <rich:columnGroup>
                            <rich:column colspan="4">
                                <h:outputText value="#{msgs['forms.cliente.filtra.cidades']}" />
                            </rich:column>
                            <rich:column breakBefore="true">
                                <h:outputText value="Sigla UF" />
                            </rich:column>
                            <rich:column>
                                <h:outputText value="Nome UF" />
                            </rich:column>
                            <rich:column>
                                <h:outputText value="Nome Cidade" />
                            </rich:column>
                            <rich:column>
                            </rich:column>
                        </rich:columnGroup>
                    </f:facet>
                    <rich:column>
                        <h:outputText value="#{cid.uf.sigla}" />
                    </rich:column>
                    <rich:column filterBy="#{cid.uf.nome}" 
                                 filterEvent="onkeyup"
                                 filterValue="#{clienteCB.clienteMB.filtroUF}">
                        <h:outputText value="#{cid.uf.nome}" />
                    </rich:column>
                    <rich:column filterBy="#{cid.nome}" filterEvent="onkeyup"
                        filterValue="#{clienteCB.clienteMB.filtroCidade}" >
                        <h:outputText value="#{cid.nome}" />
                    </rich:column>
                    <rich:column >
                    <!--    <a4j:commandLink ajaxSingle="true" 
                                         id="selectPlace" 
                                         reRender="localidadeCli" 
                                         oncomplete="#{rich:component('chooseLocal')}.hide();"
                                         >
                            <h:graphicImage value="/imgs/edit.gif" style="border:0" />
                            <f:setPropertyActionListener value="#{cid.id}"
                                target="#{clienteBean.navigationBean.codCidade}" />
                                 -->
                        <a4j:commandLink ajaxSingle="true" 
                                         id="selectPlace" 
                                         reRender="localidadeCli,bairro" 
                                         oncomplete="#{rich:component('chooseLocal')}.hide();" >
                            <h:graphicImage value="../imgs/edit.gif" style="border:0" />
                            <f:setPropertyActionListener value="#{cid.id}"
                                target="#{clienteCB.clienteMB.codCidade}" />            
                            <!--    <rich:componentControl 
                                              for="chooseLocal" attachTo="selectPlace"
                                              operation="hide" event="onclick"  /> -->
                        </a4j:commandLink>
                    </rich:column>  
                    <f:facet name="footer">
                        <rich:datascroller id="ds" 
                                           renderIfSinglePage="false"/>
                    </f:facet>
                </rich:dataTable>
            <!--  <a4j:commandButton action="#{capitalsBean.resetFilter}" value="Reset Current Filtering" reRender="simpletable" ajaxSingle="true" limitToList="true"/> -->
        </h:form>
    </rich:modalPanel>   
   </f:view>  
   
</ui:define>
</ui:composition>